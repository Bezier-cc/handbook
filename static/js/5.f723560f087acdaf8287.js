webpackJsonp([5],{NrLg:function(t,a){},jY2U:function(t,a,e){t.exports=e.p+"static/img/default.c4b906a.png"},mvHQ:function(t,a,e){t.exports={default:e("qkKv"),__esModule:!0}},q2Ig:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("BO1k"),i=e.n(s),n=e("mvHQ"),o=e.n(n),c=e("jY2U"),l=e.n(c),r={name:"Design",data:function(){return{buttonShow:!0,bgShow:!1,canvasShow:!1,dialogueShow:!1,canvasSize:{width:"500",height:"700"},canvasStyle:{width:"0",height:"0"},canvasBackgroundImg:l.a}},components:{canvasBox:function(){return new Promise(function(t){t()}).then(e.bind(null,"NYMm"))},material:function(){return e.e(12).then(e.bind(null,"jsSX"))},sticker:function(){return e.e(8).then(e.bind(null,"uv8q"))},bubbleBox:function(){return e.e(11).then(e.bind(null,"/gBj"))},Header:function(){return e.e(9).then(e.bind(null,"7zas"))},history:function(){return e.e(10).then(e.bind(null,"1PUX"))}},methods:{isChecked:function(t){var a=t.target.checked,e=document.querySelector(".select");a?e.removeAttribute("disabled"):e.setAttribute("disabled","disabled")},changeSizeBaseOnRatio:function(){var t=document.querySelector(".select"),a=t[t.selectedIndex].value;document.querySelector(".check-box").checked&&0!==t.selectedIndex&&""!==this.canvasSize.width&&(this.canvasSize.height=parseInt(this.canvasSize.width/a[0]*a[2]))},initCanvas:function(){var t=[!0,!1,!1,!1];this.buttonShow=t[0],this.bgShow=t[1],this.canvasShow=t[2],this.dialogueShow=t[3],this.canvasStyle.height="0",this.canvasStyle.width="0",this.canvasSize.width="500",this.canvasSize.height="700",this.$bus.canvasShow=!1,this.canvasBackgroundImg=l.a},createCanvas:function(){this.bgShow=!0,this.dialogueShow=!0,this.buttonShow=!1},updateCanvasBackgroundImg:function(){void 0===this.$route.params.url?this.canvasBackgroundImg=l.a:this.canvasBackgroundImg=this.$route.params.url,this.$store.state.canvasData.setBackgroundUrl(this.canvasBackgroundImg),this.$store.state.canvasData.layers=[]},closeDialogue:function(){this.bgShow=!1,this.dialogueShow=!1,this.buttonShow=!0},confirmCanvas:function(){this.canvasShow=!0,this.bgShow=!1,this.dialogueShow=!1,this.buttonShow=!1,this.canvasStyle.width=this.canvasSize.width/14.4+"vw",this.canvasStyle.height=this.canvasSize.height/8.21+"vh",this.$bus.canvasShow=!0,this.$store.state.canvasData.setSize(this.canvasSize.width,this.canvasSize.height)},handleOpen:function(){},handleClose:function(){},saveToJson:function(){if(this.canvasShow&&this.$store.state.canvasData.layers.length){if(confirm("确定保存?")){this.$store.state.oldData.push(this.$store.state.canvasData.toJSON());var t=JSON.parse(localStorage.getItem("canvasData"));t.push(this.$store.state.canvasData),localStorage.setItem("canvasData",o()(t)),this.$store.state.canvasData.layers=[],this.initCanvas(),this.$Message.info("保存成功！可以在历史查看保存记录哦")}}else this.$Message.info("没有可以保存的内容！")},saveToPng:function(){if(this.canvasShow&&this.$store.state.canvasData.layers.length){var t=!0,a=!1,e=void 0;try{for(var s,n=i()(this.$children);!(t=(s=n.next()).done);t=!0){s.value.$emit("saveImg")}}catch(t){a=!0,e=t}finally{try{!t&&n.return&&n.return()}finally{if(a)throw e}}}else this.$Message.info("没有可以导出的内容！")},historyImgClick:function(t){this.canvasBackgroundImg=t.backgroundUrl,this.canvasSize.width=t.width,this.canvasSize.height=t.height,this.canvasStyle.width=this.canvasSize.width/14.4+"vw",this.canvasStyle.height=this.canvasSize.height/8.21+"vh"}},beforeMount:function(){localStorage.getItem("canvasData")||localStorage.setItem("canvasData",o()([]))},mounted:function(){this.updateCanvasBackgroundImg(),this.$bus.$on("historyimgclick",this.historyImgClick)},beforeDestroy:function(){this.$store.state.canvasData.layers=[]},beforeRouteLeave:function(t,a,e){this.$store.state.canvasData.layers.length?confirm("当前有内容未保存,确定离开吗?")&&e():e()}},v={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"same_height",attrs:{id:"root"}},[e("Header"),t._v(" "),e("div",{staticClass:"body-content"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.bgShow,expression:"bgShow"}],staticClass:"bg"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.dialogueShow,expression:"dialogueShow"}],staticClass:"setting-dialogue",on:{click:t.changeSizeBaseOnRatio}},[e("div",{staticClass:"dialogue-header"},[e("span",{staticClass:"dialogue-header-left"},[t._v("新建画布")]),t._v(" "),e("span",{staticClass:"dialogue-header-right",on:{click:t.closeDialogue}},[t._v("×")])]),t._v(" "),e("div",{staticClass:"dialogue-body"},[e("ul",[e("li",{staticClass:"sizeIpt"},[e("div",{staticClass:"canvas-width"},[e("label",{attrs:{for:"canvas-width"}},[t._v("宽度:")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.canvasSize.width,expression:"canvasSize.width"}],attrs:{type:"text"},domProps:{value:t.canvasSize.width},on:{input:function(a){a.target.composing||t.$set(t.canvasSize,"width",a.target.value)}}}),e("span",[t._v("px")])]),t._v(" "),e("div",{staticClass:"canvas-heigth"},[e("label",{attrs:{for:"canvas-height"}},[t._v("高度:")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.canvasSize.height,expression:"canvasSize.height"}],attrs:{type:"text"},domProps:{value:t.canvasSize.height},on:{input:function(a){a.target.composing||t.$set(t.canvasSize,"height",a.target.value)}}}),e("span",[t._v("px")])])]),t._v(" "),e("li",{staticClass:"aspect-ratio"},[e("input",{staticClass:"check-box",attrs:{type:"checkbox"},on:{click:t.isChecked}}),t._v(" "),t._m(0)]),t._v(" "),e("li",{staticClass:"dialogue-button"},[e("Button",{staticClass:"dialogue-confirm",attrs:{type:"primary"},on:{click:t.confirmCanvas}},[t._v("确认")]),t._v(" "),e("Button",{staticClass:"dialogue-cancel",attrs:{type:"primary"},on:{click:t.closeDialogue}},[t._v("取消")])],1)])])])]),t._v(" "),e("div",{staticClass:"wrap"},[e("div",{staticClass:"design-panel"},[e("el-row",{staticClass:"tac"},[e("el-col",{attrs:{span:24}},[e("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"2",collapse:!0},on:{open:t.handleOpen,close:t.handleClose}},[e("el-submenu",{attrs:{index:"素材"}},[e("template",{slot:"title"},[e("i",{staticClass:"iconfont icon-sucaizhongxin"},[t._v("素材")])]),t._v(" "),e("material")],2),t._v(" "),e("el-submenu",{attrs:{index:"文字"}},[e("template",{slot:"title"},[e("i",{staticClass:"iconfont icon-wenzi- "},[t._v("文字")])]),t._v(" "),e("bubble-box")],2),t._v(" "),e("el-submenu",{attrs:{index:"贴纸"}},[e("template",{slot:"title"},[e("i",{staticClass:"iconfont icon-ziyuan"},[t._v("贴纸")])]),t._v(" "),e("sticker")],2),t._v(" "),e("el-submenu",{attrs:{index:"历史"}},[e("template",{slot:"title"},[e("i",{staticClass:"iconfont icon-yemiankuangjia"},[t._v("历史")])]),t._v(" "),e("history")],2)],1)],1)],1)],1),t._v(" "),e("div",{attrs:{id:"canvas-box"}},[e("div",{staticClass:"button"},[e("button",{staticClass:"save-button",staticStyle:{cursor:"pointer"},attrs:{id:"save-button"},on:{click:t.saveToJson}},[t._v("\n          保存\n        ")]),t._v(" "),e("button",{staticClass:"save-button",staticStyle:{cursor:"pointer"},attrs:{id:"save-button2"},on:{click:t.saveToPng}},[t._v("\n          导出图片\n        ")])]),t._v(" "),t.buttonShow?e("Button",{staticClass:"create-canvas",attrs:{type:"primary"},on:{click:t.createCanvas}},[t._v("新建画布")]):t._e(),t._v(" "),e("canvas-box",{directives:[{name:"show",rawName:"v-show",value:t.canvasShow,expression:"canvasShow"}],style:{backgroundImage:"url("+t.canvasBackgroundImg+")"},attrs:{id:"canvas-view",canvasStyle:t.canvasStyle}})],1)])])],1)},staticRenderFns:[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("select",{staticClass:"select",attrs:{disabled:"disabled"}},[e("option",{attrs:{value:""}},[t._v("请选择宽高比")]),t._v(" "),e("option",[t._v("2:1")]),t._v(" "),e("option",[t._v("4:3")]),t._v(" "),e("option",[t._v("1:1")]),t._v(" "),e("option",[t._v("3:4")]),t._v(" "),e("option",[t._v("1:2")])])}]};var h=e("VU/8")(r,v,!1,function(t){e("NrLg")},"data-v-dab2a4b0",null);a.default=h.exports},qkKv:function(t,a,e){var s=e("FeBl"),i=s.JSON||(s.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}}});
//# sourceMappingURL=5.f723560f087acdaf8287.js.map