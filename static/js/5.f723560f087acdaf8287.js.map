{"version":3,"sources":["webpack:///./src/assets/default.png","webpack:///./node_modules/babel-runtime/core-js/json/stringify.js","webpack:///src/components/design.vue","webpack:///./src/components/design.vue?4e16","webpack:///./src/components/design.vue","webpack:///./node_modules/core-js/library/fn/json/stringify.js"],"names":["module","exports","__webpack_require__","p","default","__esModule","design","name","data","buttonShow","bgShow","canvasShow","dialogueShow","canvasSize","width","height","canvasStyle","canvasBackgroundImg","default_default","a","components","canvasBox","Promise","resolve","then","bind","material","e","sticker","bubbleBox","Header","history","methods","isChecked","checked","target","select","document","querySelector","removeAttribute","setAttribute","changeSizeBaseOnRatio","slContent","selectedIndex","value","this","parseInt","initCanvas","_ref","$bus","createCanvas","updateCanvasBackgroundImg","$route","params","url","$store","state","canvasData","setBackgroundUrl","layers","closeDialogue","confirmCanvas","setSize","handleOpen","handleClose","saveToJson","length","confirm","oldData","push","toJSON","curLocalStorage","JSON","parse","localStorage","getItem","setItem","stringify_default","$Message","info","saveToPng","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","get_iterator_default","$children","next","done","$emit","err","return","historyImgClick","backgroundUrl","beforeMount","mounted","$on","beforeDestroy","beforeRouteLeave","to","from","components_design","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","id","_v","directives","rawName","expression","on","click","for","type","domProps","input","$event","composing","$set","_m","span","default-active","collapse","open","close","index","slot","staticStyle","cursor","_e","style","backgroundImage","staticRenderFns","disabled","Component","normalizeComponent","ssrContext","__webpack_exports__","core","$JSON","stringify","it","apply","arguments"],"mappings":"4DAAAA,EAAAC,QAAiBC,EAAAC,EAAuB,uDCAxCH,EAAAC,SAAkBG,QAAYF,EAAQ,QAAmCG,YAAA,0JCiGzEC,GACAC,KAAA,SACAC,KAFA,WAGA,OAEAC,YAAA,EAEAC,QAAA,EAEAC,YAAA,EAEAC,cAAA,EACAC,YACAC,MAAA,MACAC,OAAA,OAGAC,aACAF,MAAA,IACAC,OAAA,KAEAE,oBAAAC,EAAAC,IAGAC,YACAC,UAAA,sBAAAC,QAAA,SAAAC,SAAAC,KAAAtB,EAAAuB,KAAA,eACAC,SAAA,kBAAAxB,EAAAyB,EAAA,IAAAH,KAAAtB,EAAAuB,KAAA,eACAG,QAAA,kBAAA1B,EAAAyB,EAAA,GAAAH,KAAAtB,EAAAuB,KAAA,eACAI,UAAA,kBAAA3B,EAAAyB,EAAA,IAAAH,KAAAtB,EAAAuB,KAAA,eACAK,OAAA,kBAAA5B,EAAAyB,EAAA,GAAAH,KAAAtB,EAAAuB,KAAA,eACAM,QAAA,kBAAA7B,EAAAyB,EAAA,IAAAH,KAAAtB,EAAAuB,KAAA,gBAEAO,SACAC,UADA,SACAN,GACA,IAAAO,EAAAP,EAAAQ,OAAAD,QACAE,EAAAC,SAAAC,cAAA,WACAJ,EAGAE,EAAAG,gBAAA,YAFAH,EAAAI,aAAA,wBAKAC,sBAVA,WAWA,IAAAL,EAAAC,SAAAC,cAAA,WACAI,EAAAN,IAAAO,eAAAC,MACAP,SAAAC,cAAA,cAAAJ,SACA,IAAAE,EAAAO,eACA,KAAAE,KAAAhC,WAAAC,QACA+B,KAAAhC,WAAAE,OAAA+B,SAAAD,KAAAhC,WAAAC,MAAA4B,EAAA,GAAAA,EAAA,MAKAK,WArBA,WAqBA,IAAAC,IAEA,YAAAH,KAAApC,WAFAuC,EAAA,GAEAH,KAAAnC,OAFAsC,EAAA,GAEAH,KAAAlC,WAFAqC,EAAA,GAEAH,KAAAjC,aAFAoC,EAAA,GAGAH,KAAA7B,YAAAD,OAAA,IACA8B,KAAA7B,YAAAF,MAAA,IACA+B,KAAAhC,WAAAC,MAAA,MACA+B,KAAAhC,WAAAE,OAAA,MAEA8B,KAAAI,KAAAtC,YAAA,EACAkC,KAAA5B,oBAAAC,EAAAC,GAEA+B,aAhCA,WAkCAL,KAAAnC,QAAA,EACAmC,KAAAjC,cAAA,EACAiC,KAAApC,YAAA,GAEA0C,0BAtCA,gBAwCA,IAAAN,KAAAO,OAAAC,OAAAC,IACAT,KAAA5B,oBAAAC,EAAAC,EAEA0B,KAAA5B,oBAAA4B,KAAAO,OAAAC,OAAAC,IAGAT,KAAAU,OAAAC,MAAAC,WAAAC,iBAAAb,KAAA5B,qBACA4B,KAAAU,OAAAC,MAAAC,WAAAE,WAGAC,cAlDA,WAmDAf,KAAAnC,QAAA,EACAmC,KAAAjC,cAAA,EACAiC,KAAApC,YAAA,GAGAoD,cAxDA,WAyDAhB,KAAAlC,YAAA,EACAkC,KAAAnC,QAAA,EACAmC,KAAAjC,cAAA,EACAiC,KAAApC,YAAA,EACAoC,KAAA7B,YAAAF,MAAA+B,KAAAhC,WAAAC,MAAA,UACA+B,KAAA7B,YAAAD,OAAA8B,KAAAhC,WAAAE,OAAA,UACA8B,KAAAI,KAAAtC,YAAA,EACAkC,KAAAU,OAAAC,MAAAC,WAAAK,QAAAjB,KAAAhC,WAAAC,MAAA+B,KAAAhC,WAAAE,SAGAgD,WAnEA,aAoEAC,YApEA,aAsEAC,WAtEA,WAwEA,GAAApB,KAAAlC,YAAAkC,KAAAU,OAAAC,MAAAC,WAAAE,OAAAO,QAIA,GAAAC,QAAA,UAEAtB,KAAAU,OAAAC,MAAAY,QAAAC,KAAAxB,KAAAU,OAAAC,MAAAC,WAAAa,UAEA,IAAAC,EAAAC,KAAAC,MAAAC,aAAAC,QAAA,eACAJ,EAAAF,KAAAxB,KAAAU,OAAAC,MAAAC,YACAiB,aAAAE,QAAA,aAAAC,IAAAN,IACA1B,KAAAU,OAAAC,MAAAC,WAAAE,UACAd,KAAAE,aACAF,KAAAiC,SAAAC,KAAA,2BAZAlC,KAAAiC,SAAAC,KAAA,eAeAC,UAxFA,WAyFA,GAAAnC,KAAAlC,YAAAkC,KAAAU,OAAAC,MAAAC,WAAAE,OAAAO,OAAA,CADA,IAAAe,GAAA,EAAAC,GAAA,EAAAC,OAAAC,EAAA,IAKA,QAAAC,EAAAC,EAAAC,IAAA1C,KAAA2C,aAAAP,GAAAI,EAAAC,EAAAG,QAAAC,MAAAT,GAAA,GAAAI,EAAAzC,MACA+C,MAAA,YANA,MAAAC,GAAAV,GAAA,EAAAC,EAAAS,EAAA,aAAAX,GAAAK,EAAAO,QAAAP,EAAAO,SAAA,WAAAX,EAAA,MAAAC,SAEAtC,KAAAiC,SAAAC,KAAA,eASAe,gBAnGA,SAmGArC,GACAZ,KAAA5B,oBAAAwC,EAAAsC,cAEAlD,KAAAhC,WAAAC,MAAA2C,EAAA3C,MACA+B,KAAAhC,WAAAE,OAAA0C,EAAA1C,OACA8B,KAAA7B,YAAAF,MAAA+B,KAAAhC,WAAAC,MAAA,UACA+B,KAAA7B,YAAAD,OAAA8B,KAAAhC,WAAAE,OAAA,YAGAiF,YA5IA,WA6IAtB,aAAAC,QAAA,eACAD,aAAAE,QAAA,aAAAC,UAGAoB,QAjJA,WAmJApD,KAAAM,4BAEAN,KAAAI,KAAAiD,IAAA,kBAAArD,KAAAiD,kBAEAK,cAvJA,WAwJAtD,KAAAU,OAAAC,MAAAC,WAAAE,WAGAyC,iBA3JA,SA2JAC,EAAAC,EAAAb,GACA5C,KAAAU,OAAAC,MAAAC,WAAAE,OAAAO,OACAC,QAAA,oBACAsB,IAGAA,MC/Pec,GADEC,OAFjB,WAA0B,IAAAC,EAAA5D,KAAa6D,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,cAAAC,OAAiCC,GAAA,UAAaJ,EAAA,UAAAH,EAAAQ,GAAA,KAAAL,EAAA,OAAqCE,YAAA,iBAA2BF,EAAA,OAAYM,aAAa3G,KAAA,OAAA4G,QAAA,SAAAvE,MAAA6D,EAAA,OAAAW,WAAA,WAAoEN,YAAA,OAAmBF,EAAA,OAAYM,aAAa3G,KAAA,OAAA4G,QAAA,SAAAvE,MAAA6D,EAAA,aAAAW,WAAA,iBAAgFN,YAAA,mBAAAO,IAAqCC,MAAAb,EAAAhE,yBAAmCmE,EAAA,OAAYE,YAAA,oBAA8BF,EAAA,QAAaE,YAAA,yBAAmCL,EAAAQ,GAAA,UAAAR,EAAAQ,GAAA,KAAAL,EAAA,QAA0CE,YAAA,wBAAAO,IAAwCC,MAAAb,EAAA7C,iBAA2B6C,EAAAQ,GAAA,SAAAR,EAAAQ,GAAA,KAAAL,EAAA,OAAwCE,YAAA,kBAA4BF,EAAA,MAAAA,EAAA,MAAoBE,YAAA,YAAsBF,EAAA,OAAYE,YAAA,iBAA2BF,EAAA,SAAcG,OAAOQ,IAAA,kBAAsBd,EAAAQ,GAAA,SAAAR,EAAAQ,GAAA,KAAAL,EAAA,SAA0CM,aAAa3G,KAAA,QAAA4G,QAAA,UAAAvE,MAAA6D,EAAA5F,WAAA,MAAAuG,WAAA,qBAA0FL,OAASS,KAAA,QAAcC,UAAW7E,MAAA6D,EAAA5F,WAAA,OAA+BwG,IAAKK,MAAA,SAAAC,GAAyBA,EAAAxF,OAAAyF,WAAsCnB,EAAAoB,KAAApB,EAAA5F,WAAA,QAAA8G,EAAAxF,OAAAS,WAAyDgE,EAAA,QAAAH,EAAAQ,GAAA,UAAAR,EAAAQ,GAAA,KAAAL,EAAA,OAAoDE,YAAA,kBAA4BF,EAAA,SAAcG,OAAOQ,IAAA,mBAAuBd,EAAAQ,GAAA,SAAAR,EAAAQ,GAAA,KAAAL,EAAA,SAA0CM,aAAa3G,KAAA,QAAA4G,QAAA,UAAAvE,MAAA6D,EAAA5F,WAAA,OAAAuG,WAAA,sBAA4FL,OAASS,KAAA,QAAcC,UAAW7E,MAAA6D,EAAA5F,WAAA,QAAgCwG,IAAKK,MAAA,SAAAC,GAAyBA,EAAAxF,OAAAyF,WAAsCnB,EAAAoB,KAAApB,EAAA5F,WAAA,SAAA8G,EAAAxF,OAAAS,WAA0DgE,EAAA,QAAAH,EAAAQ,GAAA,YAAAR,EAAAQ,GAAA,KAAAL,EAAA,MAAqDE,YAAA,iBAA2BF,EAAA,SAAcE,YAAA,YAAAC,OAA+BS,KAAA,YAAkBH,IAAKC,MAAAb,EAAAxE,aAAuBwE,EAAAQ,GAAA,KAAAR,EAAAqB,GAAA,KAAArB,EAAAQ,GAAA,KAAAL,EAAA,MAA+CE,YAAA,oBAA8BF,EAAA,UAAeE,YAAA,mBAAAC,OAAsCS,KAAA,WAAiBH,IAAKC,MAAAb,EAAA5C,iBAA2B4C,EAAAQ,GAAA,QAAAR,EAAAQ,GAAA,KAAAL,EAAA,UAA0CE,YAAA,kBAAAC,OAAqCS,KAAA,WAAiBH,IAAKC,MAAAb,EAAA7C,iBAA2B6C,EAAAQ,GAAA,oBAAAR,EAAAQ,GAAA,KAAAL,EAAA,OAAmDE,YAAA,SAAmBF,EAAA,OAAYE,YAAA,iBAA2BF,EAAA,UAAeE,YAAA,QAAkBF,EAAA,UAAeG,OAAOgB,KAAA,MAAWnB,EAAA,WAAgBE,YAAA,wBAAAC,OAA2CiB,iBAAA,IAAAC,UAAA,GAAqCZ,IAAKa,KAAAzB,EAAA1C,WAAAoE,MAAA1B,EAAAzC,eAA+C4C,EAAA,cAAmBG,OAAOqB,MAAA,QAAcxB,EAAA,YAAiByB,KAAA,UAAazB,EAAA,KAAUE,YAAA,gCAA0CL,EAAAQ,GAAA,UAAAR,EAAAQ,GAAA,KAAAL,EAAA,gBAAAH,EAAAQ,GAAA,KAAAL,EAAA,cAA+EG,OAAOqB,MAAA,QAAcxB,EAAA,YAAiByB,KAAA,UAAazB,EAAA,KAAUE,YAAA,0BAAoCL,EAAAQ,GAAA,UAAAR,EAAAQ,GAAA,KAAAL,EAAA,kBAAAH,EAAAQ,GAAA,KAAAL,EAAA,cAAiFG,OAAOqB,MAAA,QAAcxB,EAAA,YAAiByB,KAAA,UAAazB,EAAA,KAAUE,YAAA,yBAAmCL,EAAAQ,GAAA,UAAAR,EAAAQ,GAAA,KAAAL,EAAA,eAAAH,EAAAQ,GAAA,KAAAL,EAAA,cAA8EG,OAAOqB,MAAA,QAAcxB,EAAA,YAAiByB,KAAA,UAAazB,EAAA,KAAUE,YAAA,iCAA2CL,EAAAQ,GAAA,UAAAR,EAAAQ,GAAA,KAAAL,EAAA,+BAAAH,EAAAQ,GAAA,KAAAL,EAAA,OAAuFG,OAAOC,GAAA,gBAAmBJ,EAAA,OAAYE,YAAA,WAAqBF,EAAA,UAAeE,YAAA,cAAAwB,aAAuCC,OAAA,WAAmBxB,OAAQC,GAAA,eAAmBK,IAAKC,MAAAb,EAAAxC,cAAwBwC,EAAAQ,GAAA,8BAAAR,EAAAQ,GAAA,KAAAL,EAAA,UAAgEE,YAAA,cAAAwB,aAAuCC,OAAA,WAAmBxB,OAAQC,GAAA,gBAAoBK,IAAKC,MAAAb,EAAAzB,aAAuByB,EAAAQ,GAAA,kCAAAR,EAAAQ,GAAA,KAAAR,EAAA,WAAAG,EAAA,UAAqFE,YAAA,gBAAAC,OAAmCS,KAAA,WAAiBH,IAAKC,MAAAb,EAAAvD,gBAA0BuD,EAAAQ,GAAA,UAAAR,EAAA+B,KAAA/B,EAAAQ,GAAA,KAAAL,EAAA,cAAyDM,aAAa3G,KAAA,OAAA4G,QAAA,SAAAvE,MAAA6D,EAAA,WAAAW,WAAA,eAA4EqB,OAAUC,gBAAA,OAAAjC,EAAAxF,oBAAA,KAA0D8F,OAASC,GAAA,cAAAhG,YAAAyF,EAAAzF,gBAAkD,YAE77H2H,iBADjB,WAAoC,IAAAlC,EAAA5D,KAAa6D,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,UAAoBE,YAAA,SAAAC,OAA4B6B,SAAA,cAAuBhC,EAAA,UAAeG,OAAOnE,MAAA,MAAY6D,EAAAQ,GAAA,YAAAR,EAAAQ,GAAA,KAAAL,EAAA,UAAAH,EAAAQ,GAAA,SAAAR,EAAAQ,GAAA,KAAAL,EAAA,UAAAH,EAAAQ,GAAA,SAAAR,EAAAQ,GAAA,KAAAL,EAAA,UAAAH,EAAAQ,GAAA,SAAAR,EAAAQ,GAAA,KAAAL,EAAA,UAAAH,EAAAQ,GAAA,SAAAR,EAAAQ,GAAA,KAAAL,EAAA,UAAAH,EAAAQ,GAAA,cCE5M,IAcA4B,EAdyB3I,EAAQ,OAcjC4I,CACExI,EACAiG,GATF,EAVA,SAAAwC,GACE7I,EAAQ,SAaV,kBAEA,MAUe8I,EAAA,QAAAH,EAAiB,8BC1BhC,IAAAI,EAAW/I,EAAQ,QACnBgJ,EAAAD,EAAAzE,OAAAyE,EAAAzE,MAAuC2E,UAAA3E,KAAA2E,YACvCnJ,EAAAC,QAAA,SAAAmJ,GACA,OAAAF,EAAAC,UAAAE,MAAAH,EAAAI","file":"static/js/5.f723560f087acdaf8287.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/img/default.c4b906a.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/default.png\n// module id = jY2U\n// module chunks = 5","module.exports = { \"default\": require(\"core-js/library/fn/json/stringify\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/json/stringify.js\n// module id = mvHQ\n// module chunks = 5","<template>\n  <div id=\"root\" class=\"same_height\">\n    <Header></Header>\n    <!-- <router-link to=\"/\" id=\"go-back\">\n      返回首页\n    </router-link> -->\n    <!-- 黑色背景与对话框 -->\n    <div class='body-content'>\n      <div class=\"bg\" v-show=\"bgShow\">\n      <div class=\"setting-dialogue\" v-show=\"dialogueShow\" @click=\"changeSizeBaseOnRatio\">\n        <div class=\"dialogue-header\">\n          <span class=\"dialogue-header-left\">新建画布</span>\n          <span class=\"dialogue-header-right\" @click=\"closeDialogue\">×</span>\n        </div>\n        <div class=\"dialogue-body\">\n          <ul>\n            <li class=\"sizeIpt\">\n              <div class=\"canvas-width\"><label for=\"canvas-width\">宽度:</label> <input type=\"text\" v-model=\"canvasSize.width\" /><span>px</span></div>\n              <div class=\"canvas-heigth\"><label for=\"canvas-height\">高度:</label> <input type=\"text\" v-model=\"canvasSize.height\" /><span>px</span></div>\n            </li>\n            <li class=\"aspect-ratio\">\n              <input type=\"checkbox\" class=\"check-box\" @click=\"isChecked\" />\n              <select class=\"select\" disabled=\"disabled\">\n                <option value=\"\">请选择宽高比</option>\n                <option>2:1</option>\n                <option>4:3</option>\n                <option>1:1</option>\n                <option>3:4</option>\n                <option>1:2</option>\n              </select>\n            </li>\n            <li class=\"dialogue-button\">\n              <Button type=\"primary\" class=\"dialogue-confirm\" @click=\"confirmCanvas\">确认</Button>\n              <Button type=\"primary\" class=\"dialogue-cancel\" @click=\"closeDialogue\">取消</Button>\n            </li>\n          </ul>\n        </div>\n      </div>\n      </div>\n      <div class=\"wrap\">\n        <div class=\"design-panel\">\n        <el-row class=\"tac\">\n          <el-col :span=\"24\">\n            <el-menu default-active=\"2\" class=\"el-menu-vertical-demo\" @open=\"handleOpen\" :collapse=\"true\" @close=\"handleClose\">\n              <!--素材库-->\n              <el-submenu index=\"素材\">\n                <template slot=\"title\">\n                  <i class=\"iconfont icon-sucaizhongxin\">素材</i>\n                </template>\n                <material />\n                <!--素材库占位符-->\n              </el-submenu>\n              <!--文字-->\n              <el-submenu index=\"文字\">\n                <template slot=\"title\">\n                  <i class=\"iconfont icon-wenzi- \">文字</i>\n                </template>\n                <bubble-box />\n              </el-submenu>\n              <!--贴纸-->\n              <el-submenu index=\"贴纸\">\n                <template slot=\"title\">\n                  <i class=\"iconfont icon-ziyuan\">贴纸</i>\n                </template>\n                <sticker />\n                <!--贴纸占位符-->\n              </el-submenu>\n              <!--历史-->\n              <el-submenu index=\"历史\">\n                <template slot=\"title\">\n                  <i class=\"iconfont icon-yemiankuangjia\">历史</i>\n                </template>\n                <history />\n                <!--页面占位符-->\n              </el-submenu>\n            </el-menu>\n          </el-col>\n        </el-row>\n      </div>\n      <div id=\"canvas-box\">\n        <div class=\"button\">\n          <button @click=\"saveToJson\" id=\"save-button\" class=\"save-button\" style=\"cursor:pointer\">\n            保存\n          </button>\n          <button @click=\"saveToPng\" id=\"save-button2\" class=\"save-button\" style=\"cursor:pointer\">\n            导出图片\n          </button>\n        </div>\n        <Button type=\"primary\" class=\"create-canvas\" v-if=\"buttonShow\" @click=\"createCanvas\">新建画布</Button>\n        <canvas-box id=\"canvas-view\" v-show=\"canvasShow\" :canvasStyle=\"canvasStyle\" :style=\"{ backgroundImage: 'url(' + canvasBackgroundImg + ')' }\" />\n      </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport defaultBackground from '@/assets/default.png'\nexport default {\n  name: 'Design',\n  data () {\n    return {\n      // 控制按钮显示\n      buttonShow: true,\n      // 控制黑色背显示\n      bgShow: false,\n      // 控制画布显示\n      canvasShow: false,\n      // 控制对话框显示\n      dialogueShow: false,\n      canvasSize: {\n        width: '500',\n        height: '700'\n      },\n      // 画布样式绑定\n      canvasStyle: {\n        width: '0',\n        height: '0'\n      },\n      canvasBackgroundImg: defaultBackground\n    }\n  },\n  components: {\n    canvasBox: () => import('@/components/canvas/NotebookCanvas.vue'),\n    material: () => import('@/components//edit/Material.vue'),\n    sticker: () => import('@/components/edit/Sticker.vue'),\n    bubbleBox: () => import('@/components/edit/BubbleBox.vue'),\n    Header: () => import('@/components/home/header.vue'),\n    history: () => import('@/components/edit/History.vue')\n  },\n  methods: {\n    isChecked (e) {\n      var checked = e.target.checked\n      var select = document.querySelector('.select')\n      if (!checked) {\n        select.setAttribute('disabled', 'disabled')\n      } else {\n        select.removeAttribute('disabled')\n      }\n    },\n    changeSizeBaseOnRatio () {\n      var select = document.querySelector('.select')\n      var slContent = select[select.selectedIndex].value\n      var checked = document.querySelector('.check-box').checked\n      if (checked && select.selectedIndex !== 0) {\n        if (this.canvasSize.width !== '') {\n          this.canvasSize.height = parseInt((this.canvasSize.width / slContent[0]) * slContent[2])\n        }\n      }\n    },\n    // 点击创建画布弹出黑色透明背景和画布设置对话框\n    initCanvas () {\n      // 初始化画布，修改背景为默认背景\n      [this.buttonShow, this.bgShow, this.canvasShow, this.dialogueShow] = [true, false, false, false]\n      this.canvasStyle.height = '0'\n      this.canvasStyle.width = '0'\n      this.canvasSize.width = '500'\n      this.canvasSize.height = '700'\n      // 清空画布后，讲canvasShow的状态一变化就要传给bus，history组件要用\n      this.$bus.canvasShow = false\n      this.canvasBackgroundImg = defaultBackground\n    },\n    createCanvas () {\n      // 点击新建画布后更新信息\n      this.bgShow = true\n      this.dialogueShow = true\n      this.buttonShow = false\n    },\n    updateCanvasBackgroundImg () {\n      // 更新画布的背景，如果路由参数中不携带背景图，则背景图为默认值\n      if (typeof this.$route.params.url === 'undefined') {\n        this.canvasBackgroundImg = defaultBackground\n      } else {\n        this.canvasBackgroundImg = this.$route.params.url\n      }\n      // this.createCanvas()\n      this.$store.state.canvasData.setBackgroundUrl(this.canvasBackgroundImg)\n      this.$store.state.canvasData.layers = []\n    },\n    // 点击取消或者右上角×关闭对话框和黑色背景\n    closeDialogue () {\n      this.bgShow = false\n      this.dialogueShow = false\n      this.buttonShow = true\n    },\n    // 对话框确认按钮将动态绑定的canvasSize传值给canvasStyle并渲染出画布\n    confirmCanvas () {\n      this.canvasShow = true\n      this.bgShow = false\n      this.dialogueShow = false\n      this.buttonShow = false\n      this.canvasStyle.width = this.canvasSize.width / 14.4 + 'vw'\n      this.canvasStyle.height = this.canvasSize.height / 8.21 + 'vh'\n      this.$bus.canvasShow = true\n      this.$store.state.canvasData.setSize(this.canvasSize.width, this.canvasSize.height)\n    },\n    // 下面两个空函数别删，应该是element-ui必须要求的，不然会爆红，不好看\n    handleOpen () {},\n    handleClose () {},\n    // 保存画布\n    saveToJson () {\n      // 若画布未创建或未添加内容，则退出\n      if (!this.canvasShow || !this.$store.state.canvasData.layers.length) {\n        this.$Message.info('没有可以保存的内容！')\n        return\n      }\n      if (confirm('确定保存?')) {\n        // 保存后向oldData中存储信息，并清空当前画布，初始化画布\n        this.$store.state.oldData.push(this.$store.state.canvasData.toJSON())\n        // let curLocalStorage = JSON.parse(localStorage.getItem('canvasData'))\n        let curLocalStorage = JSON.parse(localStorage.getItem('canvasData'))\n        curLocalStorage.push(this.$store.state.canvasData)\n        localStorage.setItem('canvasData', JSON.stringify(curLocalStorage))\n        this.$store.state.canvasData.layers = []\n        this.initCanvas()\n        this.$Message.info('保存成功！可以在历史查看保存记录哦')\n      }\n    },\n    saveToPng () {\n      if (!this.canvasShow || !this.$store.state.canvasData.layers.length) {\n        this.$Message.info('没有可以导出的内容！')\n        return\n      }\n      for (const child of this.$children) {\n        child.$emit('saveImg')\n      }\n    },\n    // 点击历史中的任一保存过的图片后，调用该函数，更新画布背景\n    // canvasData包含背景图，画布高宽\n    historyImgClick (canvasData) {\n      this.canvasBackgroundImg = canvasData.backgroundUrl\n      // 重新计算画布大小\n      this.canvasSize.width = canvasData.width\n      this.canvasSize.height = canvasData.height\n      this.canvasStyle.width = this.canvasSize.width / 14.4 + 'vw'\n      this.canvasStyle.height = this.canvasSize.height / 8.21 + 'vh'\n    }\n  },\n  beforeMount () {\n    if (!localStorage.getItem('canvasData')) {\n      localStorage.setItem('canvasData', JSON.stringify([]))\n    }\n  },\n  mounted () {\n    // 更新背景图\n    this.updateCanvasBackgroundImg()\n    // 监听历史页面的点击事件\n    this.$bus.$on('historyimgclick', this.historyImgClick)\n  },\n  beforeDestroy () {\n    this.$store.state.canvasData.layers = []\n  },\n  // 以下为路由守卫\n  beforeRouteLeave (to, from, next) {\n    if (this.$store.state.canvasData.layers.length) {\n      if (confirm('当前有内容未保存,确定离开吗?')) {\n        next()\n      }\n    } else {\n      next()\n    }\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n.same_height {\n  // display: flex;\n  background-color: #ffffff;\n}\n.body-content{\n  position: absolute;\n}\n.iconfont {\n  font-weight: 600;\n  color: #efaf67;\n}\n.bg {\n  display: flex;\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.3);\n  z-index: 12;\n}\n.wrap {\n  display: flex;\n}\n.design-panel {\n  float: left;\n  width: 6.9vw;\n  height: 92vh;\n}\n.create-canvas {\n  width: 7.944vw;\n  height: 4.65vh;\n  color: #fff;\n  background-color: #efaf67;\n  border: none;\n  border-radius: 4px;\n}\n.el-menu-vertical-demo {\n  width: 6.9vw;\n  min-height: 92vh;\n}\n.el-submenu:first-child {\n  margin-top: 2vh;\n}\n.el-submenu {\n  background-color: #ffffff;\n  border-radius: 5px;\n  margin-top: 3vh;\n}\n.el-submenu:hover {\n  background-color: rgba(135, 206, 235, 1);\n}\n.setting-dialogue {\n  position: fixed;\n  left: 50%;\n  margin-left: -16.78vw;\n  top: 22.18vh;\n  background-color: #fff;\n  width: 35.56vw;\n  height: 30.9vh;\n  z-index: 20;\n  .dialogue-header {\n    position: absolute;\n    top: 0;\n    height: 4.26vh;\n    width: 100%;\n    border-bottom: 2px solid #d6d8dd;\n    line-height: 4.26vh;\n    .dialogue-header-left {\n      font-weight: bold;\n      font-size: 1.7vh;\n      color: #000;\n      margin-left: 1.39vw;\n    }\n    .dialogue-header-right {\n      position: absolute;\n      top: -0.24vh;\n      right: 0.69vw;\n      font-size: 3vh;\n      user-select: none;\n      cursor: pointer;\n    }\n  }\n  .dialogue-body {\n    position: absolute;\n    top: 4.26vh;\n    height: 26.64vh;\n    width: 100%;\n    .sizeIpt {\n      margin-top: 7.3vh;\n      display: flex;\n      justify-content: center;\n      input {\n        width: 6.94vw;\n      }\n      span {\n        margin-left: 0.69vw;\n      }\n      .canvas-width {\n        margin-right: 2.08vw;\n      }\n    }\n    .aspect-ratio {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      margin-top: 2.5vh;\n      .check-box {\n        width: 2vh;\n        height: 2vh;\n        margin-right: 1vw;\n      }\n    }\n    .dialogue-button {\n      display: flex;\n      justify-content: center;\n      margin-top: 4.52vh;\n\n      .dialogue-cancel {\n        background-color: white;\n        color: #efaf67;\n        margin-left: 2.78vw;\n        border-color: #efaf67;\n      }\n      .dialogue-confirm {\n        background-color: #efaf67;\n        border: none;\n      }\n    }\n  }\n}\n#canvas-box {\n  float: left;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 93.1vw;\n  height: 92.2vh;\n  background-color: #d6d8dd;\n  background-size: 100% 100%;\n  background-repeat: no-repeat;\n}\n#canvas-view {\n  width: 70vw;\n  height: 90vh;\n  background-color: #ffffff;\n}\n#go-back {\n  width: 5vw;\n  height: 2vh;\n  position: absolute;\n  left: 95vw;\n  z-index: 99;\n}\n.save-button {\n  position: absolute;\n  width: 8vw;\n  top: 12vh;\n  left: 8vw;\n  color: #efaf67;\n  font-size: 16px;\n  font-weight: 600;\n  border: none;\n  border-radius: 5px;\n}\n.save-button:hover {\n  background-color: rgba(135, 206, 235, 1);\n}\n#save-button2 {\n  top: 16vh;\n}\n#canvas-view {\n  background-size: 100% 100%;\n  background-repeat: no-repeat;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/design.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"same_height\",attrs:{\"id\":\"root\"}},[_c('Header'),_vm._v(\" \"),_c('div',{staticClass:\"body-content\"},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.bgShow),expression:\"bgShow\"}],staticClass:\"bg\"},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.dialogueShow),expression:\"dialogueShow\"}],staticClass:\"setting-dialogue\",on:{\"click\":_vm.changeSizeBaseOnRatio}},[_c('div',{staticClass:\"dialogue-header\"},[_c('span',{staticClass:\"dialogue-header-left\"},[_vm._v(\"新建画布\")]),_vm._v(\" \"),_c('span',{staticClass:\"dialogue-header-right\",on:{\"click\":_vm.closeDialogue}},[_vm._v(\"×\")])]),_vm._v(\" \"),_c('div',{staticClass:\"dialogue-body\"},[_c('ul',[_c('li',{staticClass:\"sizeIpt\"},[_c('div',{staticClass:\"canvas-width\"},[_c('label',{attrs:{\"for\":\"canvas-width\"}},[_vm._v(\"宽度:\")]),_vm._v(\" \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.canvasSize.width),expression:\"canvasSize.width\"}],attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.canvasSize.width)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.canvasSize, \"width\", $event.target.value)}}}),_c('span',[_vm._v(\"px\")])]),_vm._v(\" \"),_c('div',{staticClass:\"canvas-heigth\"},[_c('label',{attrs:{\"for\":\"canvas-height\"}},[_vm._v(\"高度:\")]),_vm._v(\" \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.canvasSize.height),expression:\"canvasSize.height\"}],attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.canvasSize.height)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.canvasSize, \"height\", $event.target.value)}}}),_c('span',[_vm._v(\"px\")])])]),_vm._v(\" \"),_c('li',{staticClass:\"aspect-ratio\"},[_c('input',{staticClass:\"check-box\",attrs:{\"type\":\"checkbox\"},on:{\"click\":_vm.isChecked}}),_vm._v(\" \"),_vm._m(0)]),_vm._v(\" \"),_c('li',{staticClass:\"dialogue-button\"},[_c('Button',{staticClass:\"dialogue-confirm\",attrs:{\"type\":\"primary\"},on:{\"click\":_vm.confirmCanvas}},[_vm._v(\"确认\")]),_vm._v(\" \"),_c('Button',{staticClass:\"dialogue-cancel\",attrs:{\"type\":\"primary\"},on:{\"click\":_vm.closeDialogue}},[_vm._v(\"取消\")])],1)])])])]),_vm._v(\" \"),_c('div',{staticClass:\"wrap\"},[_c('div',{staticClass:\"design-panel\"},[_c('el-row',{staticClass:\"tac\"},[_c('el-col',{attrs:{\"span\":24}},[_c('el-menu',{staticClass:\"el-menu-vertical-demo\",attrs:{\"default-active\":\"2\",\"collapse\":true},on:{\"open\":_vm.handleOpen,\"close\":_vm.handleClose}},[_c('el-submenu',{attrs:{\"index\":\"素材\"}},[_c('template',{slot:\"title\"},[_c('i',{staticClass:\"iconfont icon-sucaizhongxin\"},[_vm._v(\"素材\")])]),_vm._v(\" \"),_c('material')],2),_vm._v(\" \"),_c('el-submenu',{attrs:{\"index\":\"文字\"}},[_c('template',{slot:\"title\"},[_c('i',{staticClass:\"iconfont icon-wenzi- \"},[_vm._v(\"文字\")])]),_vm._v(\" \"),_c('bubble-box')],2),_vm._v(\" \"),_c('el-submenu',{attrs:{\"index\":\"贴纸\"}},[_c('template',{slot:\"title\"},[_c('i',{staticClass:\"iconfont icon-ziyuan\"},[_vm._v(\"贴纸\")])]),_vm._v(\" \"),_c('sticker')],2),_vm._v(\" \"),_c('el-submenu',{attrs:{\"index\":\"历史\"}},[_c('template',{slot:\"title\"},[_c('i',{staticClass:\"iconfont icon-yemiankuangjia\"},[_vm._v(\"历史\")])]),_vm._v(\" \"),_c('history')],2)],1)],1)],1)],1),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"canvas-box\"}},[_c('div',{staticClass:\"button\"},[_c('button',{staticClass:\"save-button\",staticStyle:{\"cursor\":\"pointer\"},attrs:{\"id\":\"save-button\"},on:{\"click\":_vm.saveToJson}},[_vm._v(\"\\n          保存\\n        \")]),_vm._v(\" \"),_c('button',{staticClass:\"save-button\",staticStyle:{\"cursor\":\"pointer\"},attrs:{\"id\":\"save-button2\"},on:{\"click\":_vm.saveToPng}},[_vm._v(\"\\n          导出图片\\n        \")])]),_vm._v(\" \"),(_vm.buttonShow)?_c('Button',{staticClass:\"create-canvas\",attrs:{\"type\":\"primary\"},on:{\"click\":_vm.createCanvas}},[_vm._v(\"新建画布\")]):_vm._e(),_vm._v(\" \"),_c('canvas-box',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.canvasShow),expression:\"canvasShow\"}],style:({ backgroundImage: 'url(' + _vm.canvasBackgroundImg + ')' }),attrs:{\"id\":\"canvas-view\",\"canvasStyle\":_vm.canvasStyle}})],1)])])],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('select',{staticClass:\"select\",attrs:{\"disabled\":\"disabled\"}},[_c('option',{attrs:{\"value\":\"\"}},[_vm._v(\"请选择宽高比\")]),_vm._v(\" \"),_c('option',[_vm._v(\"2:1\")]),_vm._v(\" \"),_c('option',[_vm._v(\"4:3\")]),_vm._v(\" \"),_c('option',[_vm._v(\"1:1\")]),_vm._v(\" \"),_c('option',[_vm._v(\"3:4\")]),_vm._v(\" \"),_c('option',[_vm._v(\"1:2\")])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-dab2a4b0\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/design.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-dab2a4b0\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./design.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./design.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./design.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-dab2a4b0\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./design.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-dab2a4b0\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/design.vue\n// module id = null\n// module chunks = ","var core = require('../../modules/_core');\nvar $JSON = core.JSON || (core.JSON = { stringify: JSON.stringify });\nmodule.exports = function stringify(it) { // eslint-disable-line no-unused-vars\n  return $JSON.stringify.apply($JSON, arguments);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/json/stringify.js\n// module id = qkKv\n// module chunks = 5"],"sourceRoot":""}